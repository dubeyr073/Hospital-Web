
@{
    ViewBag.Title = "Admin Profile";
    Layout = "~/Views/Shared/Admin/_Layout.cshtml";
    @*<script src="~/assets/admin/PageWiseJs/TestMaster.js"></script>*@
}
<script>
    $(document).ready(function () {
        $("#btnSave").click(function (e) {
            var testHeadData = {
                TestId: $('#TestId').val(),
                TestName: $('#TestName').val(),
                Charge: $('#Charge').val(),
                IsDescription: $('#IsDescription').val(),
                Description: $('#Description').val()
            };
            hplc.ajaxCall("POST", "/admin/managetestmaster", testHeadData, "text", function (result) {
                debugger;
                var response = JSON.parse(result);
                debugger;
                if (response.Status == 'done') {
                    $('#TestId').val(response.TestID)
                    $('#msg').html(response.Message)
                    $('#btnSave').hide();
                    $('#TestMasterDetailContainer').removeClass("hidden");
                }
                else {
                    $('#TestId').val("0")
                    $('#btnSave').show();
                    $('#TestMasterDetailContainer').addClass("hidden");
                }
            });
        });
        //Save TestDetail
        $("#btnTestDetail").click(function (e) {
            var testDetail = {
                TestDetailID: $('#TestDetailID').val(),
                FieldName: $('#FieldName').val(),
                FieldDefaultValue: $('#FieldDefaultValue').val(),
                HeadName: $('#HeadName').val(),
                Unit: $('#Unit').val()
            };
            hplc.ajaxCall("POST", "/admin/ManageTestMasterDetail", testDetail, "text", function (result) {
                var response = JSON.parse(result);
                if (response === "error") {
                    $('#detailaddedmsg').html(response.Message)
                }
                else {
                    if (response.Status === 'done') {
                        $('#detailaddedmsg').html(response.Message)
                        //Reset Form
                        $('#TestDetailID').val("0");
                        $('#FieldName').val("");
                        $('#FieldDefaultValue').val("");
                        $('#HeadName').val("");
                        $('#Unit').val("");
                        if (response.tmdList != "null") {
                            var fields = [
                                { name: "TestDetailID", css: "hidden", },
                                { name: "TestMasterID", css: "hidden", },
                                { name: "FieldName", type: "text", title: "Field Name", sorting: true, filtering: true, width: 50 },
                                { name: "FieldDefaultValue", type: "text", title: "Field", sorting: true, filtering: false, width: 50 },
                                { name: "HeadName", type: "text", title: "Head Name", sorting: true, filtering: false, width: 50 },
                                { name: "Unit", type: "text", title: "Unit", sorting: true, filtering: false, width: 50 },
                            ];
                            var options = {
                                filtering: true,
                                editing: false,
                                sorting: true,
                                paging: true,
                                autoload: true,
                                controller: {
                                    tmdList: response.tmdList,
                                    loadData: function (filter) {
                                        return $.grep(this.tmdList, function (tmdList) {
                                            return (!filter.FieldName || tmdList.FieldName.toLowerCase().indexOf(filter.FieldName.toLowerCase()) > -1);
                                        });
                                    }
                                },
                                fields: fields
                            };
                            $.extend(options, hplc.grid_options);
                            $("#tmdList").jsGrid(options);
                            hplc.filteOnKeyPress("#tmdList");
                        }
                    }
                }
            });
        });
        $("#btnResetAll").click(function (e)
        {
            window.open('TestMaster', '_self'); return false;
        });
    });
</script>
<div id="page-wrapper" class="gray-bg dashbard-1">
    <div class="content-main">
        <!--banner-->
        <div class="banner">
            
                <h2>
                    <a href="/home/dashboard">Test Master</a>
                    <i class="fa fa-angle-right"></i>
                    <span>Create Test</span>
                </h2>
            
        </div>
        <div >
            <div > </div>
        </div>
            <!--//banner-->
            <!--content-->
            <div class="blank">
                <div class="blank-page">
                    <form id="frmTestHead" novalidate="novalidate">
                        <div class="col-lg-12"><p style="color:#ef0f44; text-align:center" id="msg"></p></div>

                        <div class="clearfix"></div>

                        <input type="hidden" name="TestId" id="TestId" autocomplete="off" value="0" />
                        <div class="col-md-4 form-group">
                            Test Name :
                            <input type="text" name="TestName" id="TestName" autocomplete="off" class="form-control" placeholder="Enter Test Name" required />
                        </div>
                        <div class="col-md-4 form-group">
                            Charge : <input type="number" name="Charge" id="Charge" autocomplete="off" class="form-control" placeholder="Enter Charge" required />
                        </div>
                        <div class="col-md-4 form-group">
                            Is Description : <input type="checkbox" name="IsDescription" id="IsDescription" class="form-control" />
                        </div>
                        <div class="col-md-12 form-group">
                            Description :
                            <input type="text" name="Description" id="Description" class="form-control" autocomplete="off" placeholder="Enter Description" />
                        </div>

                        <div class="col-lg-12 form-group">
                            <br />
                            <button type="button" name="btnResetAll" id="btnResetAll" class="btn btn-primary float-right">Reset All</button>&nbsp;
                            <button type="button" id="btnSave" class="btn btn-primary float-right">Submit</button>
                        </div>
                    </form>
                </div>
                <div class="blank-page hidden" id="TestMasterDetailContainer">
                    @*@using (Html.BeginForm("ManageTestMasterDetail", "admin", FormMethod.Post, new { enctype = "multipart/form-data", @id = "manage-testdetailes-form" }))
                {*@
                    <form id="frmTestDetail" novalidate="novalidate">
                        <div class="col-lg-12"><p style="color:#ef0f44; text-align:center" id="detailaddedmsg"></p></div>
                        <input type="hidden" name="TestDetailID" id="TestDetailID" value="0" />
                        <div class="col-md-4 form-group">
                            Field Name :
                            <input type="text" name="FieldName" id="FieldName" class="form-control" placeholder="Enter Field Name" required />
                        </div>
                        <div class="col-md-4 form-group">
                            Field Default Value :
                            <input type="text" name="FieldDefaultValue" id="FieldDefaultValue" class="form-control" placeholder="Enter Default Value" required />
                        </div>
                        <div class="col-md-4 form-group">
                            Head Name :
                            <input type="text" name="HeadName" id="HeadName" class="form-control" placeholder="Enter Head Name" />
                        </div>
                        <div class="col-md-4 form-group">
                            Unit :
                            <input type="text" name="Unit" id="Unit" class="form-control" placeholder="Enter Unit" />
                        </div>
                        <div class="col-lg-12 form-group">
                            <br />
                            
                           
                            <button type="button" name="btnTestDetail" id="btnTestDetail" class="btn btn-primary float-right">Add</button>

                        </div>
                        @* }*@
                    </form>
                </div>
                <div class="blank-page">
                    <div id="tmdList"></div>
                </div>
            </div>
            <!--//content-->
            <!---->
        </div>
    <div class="clearfix"> </div>
</div>
